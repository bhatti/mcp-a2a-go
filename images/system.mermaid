%%{init: {'theme':'base', 'themeVariables': { 'primaryColor':'#2E3440', 'primaryTextColor':'#D8DEE9', 'primaryBorderColor':'#4C566A', 'lineColor':'#88C0D0', 'secondaryColor':'#3B4252', 'tertiaryColor':'#434C5E', 'background':'#2E3440', 'mainBkg':'#2E3440', 'secondBkg':'#3B4252', 'fontSize':'16px'}}}%%
graph TB
    subgraph "Client Layer"
        UI[Streamlit UI<br/>Port 8501]
        CLI[CLI Workflows<br/>Python]
    end

    subgraph "Protocol Servers"
        MCP[MCP Server<br/>Go - Port 8080]
        A2A[A2A Server<br/>Go - Port 8082]
    end

    subgraph "Orchestration"
        LG[LangGraph Workflows<br/>RAG, Research, Hybrid]
    end

    subgraph "Data & AI"
        PG[(PostgreSQL + pgvector<br/>Port 5432)]
        OL[Ollama<br/>Port 11434]
    end

    UI -->|JWT Auth| MCP
    UI -->|SSE Streaming| A2A
    CLI --> MCP
    CLI --> A2A
    A2A --> LG
    LG -->|MCP Calls| MCP
    MCP -->|SQL + RLS| PG
    LG -->|LLM Calls| OL

    style UI fill:#5E81AC,stroke:#81A1C1,color:#ECEFF4
    style MCP fill:#BF616A,stroke:#D08770,color:#ECEFF4
    style A2A fill:#D08770,stroke:#EBCB8B,color:#2E3440
    style LG fill:#A3BE8C,stroke:#B48EAD,color:#2E3440
    style PG fill:#B48EAD,stroke:#8FBCBB,color:#ECEFF4
    style OL fill:#88C0D0,stroke:#5E81AC,color:#2E3440
